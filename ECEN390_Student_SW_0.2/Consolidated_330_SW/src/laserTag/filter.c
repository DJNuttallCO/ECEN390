/*
 * filter.c
 *
 *  Created on: Feb 12, 2015
 *      Author: DJ
 */

#include "filter.h"
#include <stdio.h>
#include <stdbool.h>
#include <math.h>

#define FIR_COEF_COUNT 23
#define IIR_A_COEFFICIENT_COUNT 10
#define IIR_B_COEFFICIENT_COUNT 11
#define X_QUEUE_SIZE FIR_COEF_COUNT
#define Y_QUEUE_SIZE IIR_B_COEFFICIENT_COUNT
#define Z_QUEUE_SIZE IIR_A_COEFFICIENT_COUNT
#define TEST_DATA_COUNT 200

static queue_t xQueue;
static queue_t yQueue;
static queue_t zQueue[FILTER_IIR_FILTER_COUNT];
const double firBcoeff[FIR_COEF_COUNT] = {3.66000121597220e-05,-9.37983887116858e-20,-0.000853962386806215,-0.00403760479059139,-0.00991457334688855,-0.0132599560706162,5.44337364799067e-18,0.0482283541041642,0.139662648737947,0.257391560533714,0.359393702205797,0.400000000000000,0.359393702205797,0.257391560533714,0.139662648737947,0.0482283541041642,5.44337364799067e-18,-0.0132599560706162,-0.00991457334688855,-0.00403760479059139,-0.000853962386806215,-9.37983887116858e-20,3.66000121597220e-05};
const double iirAcoeff[FILTER_IIR_FILTER_COUNT][IIR_A_COEFFICIENT_COUNT] = {
		{-7.50908233436483,27.3536234378542,-62.7047362383248,99.6056348149310,-114.201323557917,95.6364834552749,-57.8068381560701,24.2120744276596,-6.38177025817259,0.816001991091691},
		{-6.29194005597338,20.6337901482619,-44.0830343370639,67.3521268296519,-76.2027888099491,64.6682906068794,-40.6397413062424,18.2640342667276,-5.34735326201643,0.816001991091691},
		{-4.61133311111593,13.3033688234532,-25.5462259540365,37.3198096123076,-41.2191241638579,35.8327505569946,-23.5508813353508,11.7755339487145,-3.91904991697435,0.816001991091691},
		{-3.02733884440592,8.46301225921762,-13.8397950897333,20.4359177185006,-21.0755101492580,19.6216605882214,-12.7588357687685,7.49110694039951,-2.57285512907809,0.816001991091691},
		{-1.41082673111739,5.59296958634394,-5.63974495910365,11.5316967773596,-8.23051278388195,11.0722549972200,-5.19926137629878,4.95069732811330,-1.19902428434904,0.816001991091691},
		{0.799316646771265,5.05230246302207,3.10879754152091,9.94653465660664,4.49618453012524,9.55025778156090,2.86599087100788,4.47212745522748,0.679318054602014,0.816001991091691},
		{2.49590581850962,7.28879431773460,10.8240231518104,16.6933370566361,16.2141113685857,16.0282149382336,9.97861808311546,6.45175147239329,2.12120427110911,0.816001991091691},
		{4.88055721384935,14.3256551215320,28.0357695457067,41.1854878262130,45.7219478622461,39.5443845281485,25.8459638807170,12.6804075809757,4.14785635364698,0.816001991091691},
		{6.10124903812041,19.6883823000073,41.5931256719381,63.1768970793950,71.3231813791086,60.6594438323209,38.3443264447068,17.4272093623675,5.18529001486497,0.816001991091691},
		{7.30774244229186,26.1602101568320,59.2788462490173,93.5476489951414,107.023102536194,89.8199122320614,54.6485574114717,23.1557282627772,6.21065681477156,0.816001991091691}
};
const double iirBcoeff[FILTER_IIR_FILTER_COUNT][IIR_B_COEFFICIENT_COUNT] = {
		{1.81857317399503e-09,1.41710253893443e-10,-3.83018731144998e-08,-1.92000208135867e-09,1.27593313354420e-07,3.84054653866094e-09,-1.25025510557566e-07,-1.82484053872233e-09,3.60353970135583e-08,1.28010880664377e-10,-1.64276858702661e-09},
		{1.81857317399503e-09,1.18740530881358e-10,-5.07779721892452e-08,-2.09506755407466e-09,1.88711732857337e-07,4.48217317004345e-09,-1.84913627195124e-07,-1.99122682250396e-09,4.77731177726970e-08,1.07261680161182e-10,-1.64276858702661e-09},
		{1.81857317399503e-09,8.70243735340210e-11,-6.43876941520781e-08,-1.92423838384864e-09,2.65150607606975e-07,4.38813703846485e-09,-2.59813718844309e-07,-1.82886323658864e-09,6.05773697309566e-08,7.86115781271002e-11,-1.64276858702661e-09},
		{1.81857317399503e-09,5.71314758794070e-11,-7.33743409110129e-08,-1.43179277109733e-09,3.21210584947488e-07,3.39376739854261e-09,-3.14745117552011e-07,-1.36082525578105e-09,6.90321559253783e-08,5.16084781449741e-11,-1.64276858702661e-09},
		{1.81857317399503e-09,2.66249063951984e-11,-7.87028863067710e-08,-7.13826151786752e-10,3.56549331597328e-07,1.72941796707317e-09,-3.49372423814718e-07,-6.78444883312735e-10,7.40453397365272e-08,2.40510310412591e-11,-1.64276858702661e-09},
		{1.81857317399503e-09,-1.50845815655572e-11,-7.97066934410148e-08,4.09395045863291e-10,3.63381422486260e-07,-9.95881871485537e-10,-3.56066969819647e-07,3.89103095573817e-10,7.49897381231699e-08,-1.36263292006566e-11,-1.64276858702661e-09},
		{1.81857317399503e-09,-4.71023530553735e-11,-7.55544038295343e-08,1.21415609103647e-09,3.35479860868761e-07,-2.90403658854351e-09,-3.28727125285844e-07,1.15397575616741e-09,7.10831952463753e-08,-4.25488878208947e-11,-1.64276858702661e-09},
		{1.81857317399503e-09,-9.21051296442553e-11,-6.24897088021530e-08,1.97919850395850e-09,2.53879054369080e-07,-4.47537139478598e-09,-2.48769076571177e-07,1.88109942232649e-09,5.87917136609873e-08,-8.32011688323799e-11,-1.64276858702661e-09},
		{1.81857317399503e-09,-1.15141839143558e-10,-5.25332243618155e-08,2.09791247471367e-09,1.97997650244871e-07,-4.52740363056716e-09,-1.94012614940400e-07,1.99393048758007e-09,4.94244881040857e-08,-1.04010880124214e-10,-1.64276858702661e-09},
		{1.81857317399503e-09,-1.37910598229266e-10,-4.05175742620582e-08,1.96882462167126e-09,1.37822242855554e-07,-3.98893354396926e-09,-1.35048538799557e-07,1.87124278535202e-09,3.81199653710178e-08,-1.24578544228381e-10,-1.64276858702661e-09}
};
const double inputData[TEST_DATA_COUNT] = {1181,1421,1518,1394,1223,1305,1300,1100,1157,1054,1436,1137,1134,1305,1066,1059,1219,1372,1037,1266,1102,1127,977,1387,1496,1029,1261,1337,1326,1346,1314,1170,1224,1099,1544,1144,1071,1276,1402,1204,1270,1238,1066,1325,1076,1136,1262,1215,1275,1287,1088,1006,1422,1308,1201,1443,966,1254,1244,1507,1283,1364,1494,1069,945,1236,1183,1223,1177,986,1258,1176,1337,1376,1308,1045,1098,1350,1017,1176,1120,1123,1116,1161,1313,1138,897,989,1422,1332,1199,1305,1356,1202,1309,1268,1261,1274,1051,1310,1023,1109,1164,1281,1356,1231,1073,1207,1373,1156,1243,1453,1208,1451,1313,1249,1183,1397,1269,1043,1232,1230,1252,1386,1480,1303,1419,1084,1343,1318,1361,1358,1025,1277,1350,1049,1195,1133,1106,1371,953,1129,1300,1395,1520,1220,1335,1301,1113,1400,1242,1395,1111,1287,1240,1528,1422,1208,1009,1315,1261,1456,941,1327,1149,1345,1064,1129,1173,1259,1535,1285,1313,1357,1074,1200,1181,1104,1409,1295,1450,1388,1235,1397,1305,1724,1310,1307,1153,1111,1378,1124,1205,999,970,1349,1307,1147,1381,1180};
const double outputFIRData[TEST_DATA_COUNT] = {0.0432246143606317,0.0520086172789649,-0.952970760359682,-5.93087139238941,-18.6981006184062,-37.0203614687836,-40.5179569782633,16.9960060759601,196.527298235347,540.345585444567,1033.86556607203,1593.81790467674,2099.45532508691,2450.10627799226,2610.16829738928,2613.41197705410,2531.19314544923,2432.50095583049,2359.94242888141,2326.22034234963,2322.31403694127,2329.13867117931,2329.42132508810,2317.01446848368,2298.92861033339,2287.89355270240,2290.53621118161,2300.86090980989,2305.19079168888,2294.92910510118,2276.07898919042,2266.46324303112,2282.21773605774,2325.14122241617,2382.06651976748,2435.97061918470,2477.51853900666,2506.49887141153,2524.44293335804,2528.94130783984,2516.54939079932,2489.73656195252,2458.35235914231,2433.28232226950,2419.50270509507,2415.77048972928,2419.34545861565,2428.56432572974,2440.33837396639,2447.34972390385,2440.48136733798,2415.43878162648,2377.36041154354,2339.11353659496,2314.64331103983,2311.70011832232,2327.57912898247,2350.19961378452,2365.20808627457,2366.03847474223,2359.47834791062,2360.40657689707,2378.37257845206,2407.79483596805,2432.11565864113,2439.44368371643,2435.35230412381,2440.04908800696,2471.08598161613,2525.92102184224,2579.15660249049,2597.54792697682,2562.09708290715,2481.15701919596,2385.05655738700,2306.50008722028,2261.86417837637,2247.37537584475,2250.99034615848,2266.91392663855,2298.36258262021,2347.12694625601,2402.47759611669,2442.61083885065,2448.54374691627,2417.58162604494,2364.16051875099,2308.54530985276,2264.67737120702,2236.84181852955,2224.13076591540,2224.34998495907,2232.69316583131,2239.67057786791,2235.44010958120,2219.70170289723,2207.02568582217,2219.07317221316,2267.90836926111,2344.89329450375,2425.50862841499,2485.73089835200,2515.61019445515,2520.07398307024,2509.48800092360,2490.07886746215,2461.41980809847,2420.72420998149,2369.20478924165,2315.83498607902,2275.77733768787,2263.25962600760,2282.41428150871,2322.77526733002,2364.40621479987,2390.33928769469,2397.17522233843,2395.70793317857,2401.85687930047,2425.72091638427,2466.34526939684,2513.69544866315,2554.45733263413,2577.82962260562,2579.09719210335,2559.94271452127,2525.80807749173,2482.87213642692,2437.84976690052,2400.51479583948,2384.45635262662,2401.76537705301,2453.52770174609,2524.26545057179,2587.41137599746,2620.10093004207,2616.70088205663,2590.25200528162,2560.67968101173,2539.81264780456,2525.31037572680,2506.82106284367,2476.76473350064,2435.90788716397,2390.92437984240,2348.66535502839,2312.73959725374,2283.95824314295,2263.22275941084,2254.85193581274,2267.67716234206,2310.92442395095,2385.25988385428,2475.69514799548,2554.88142590496,2597.65998126359,2596.56555155777,2565.31358769307,2527.30513537164,2499.60167390552,2486.05209383132,2483.25430456205,2490.00001511958,2508.54275919795,2536.68809315440,2561.69203319629,2566.00917203091,2541.48445812423,2497.58710272859,2454.36112853012,2426.60889297339,2414.33882232908,2406.73103718472,2393.04483458553,2369.98467217551,2342.51994608571,2321.78189360608,2321.99102933179,2354.26642136424,2417.55792630632,2493.39951950190,2551.74984633365,2566.66321342536,2531.53857357333,2463.52236230715,2394.89439330048,2357.35888889727,2367.77896027687,2421.71297771877,2497.64510663603,2570.07295199140,2624.04879373398,2661.01938337537,2691.00303158871,2717.63341600320,2730.20079455279,2711.20503324058,2652.72183355823,2565.44452758870,2471.38703054075};
const double outputIIRData[FILTER_IIR_FILTER_COUNT][TEST_DATA_COUNT] = {{7.86071241325251e-11,6.90974214454359e-10,-3.42868006489528e-10,-2.95420217232532e-08,-1.69885596964130e-07,-3.83129734308474e-07,5.44984686984486e-07,7.47358285784879e-06,3.05019279684798e-05,7.67220963979463e-05,0.000118316932912200,3.62328157340204e-05,-0.000415487952574962,-0.00151757604021089,-0.00325280181023892,-0.00476849811144723,-0.00398797857018568,0.00197738570128554,0.0150618697801668,0.0333713426024418,0.0487798412900457,0.0475803022069201,0.0162402371044105,-0.0484148259253960,-0.129339456731643,-0.187372437988838,-0.173658420950653,-0.0559349903253448,0.151852276444764,0.374776404425091,0.493801575014327,0.397759133996542,0.0526363247154596,-0.447765297363352,-0.887816902830911,-1.00964721075236,-0.644499208196329,0.164114174413596,1.11936690131396,1.76021562564363,1.66713017198692,0.700481595862862,-0.852884526424536,-2.32891869020176,-2.95125512433367,-2.21668157115500,-0.218837071967227,2.27729566860239,4.10070751665076,4.20470263758834,2.23118266612670,-1.18254785285428,-4.56060659674942,-6.20532578094076,-5.02790117416192,-1.19581044149274,3.76535831398840,7.54827420173611,8.11903458676481,4.77721390394121,-1.31914350134014,-7.49941635684616,-10.7303577955049,-9.08564247299119,-2.83111691684647,5.46392847635536,11.9524269440921,13.2796470212322,8.29005119303468,-1.18678833962635,-10.9521809630355,-16.2828011888861,-14.2017836794261,-5.09014873564618,7.21503736509177,17.0115938858655,19.3665531736577,12.5808082819823,-0.739769666562141,-14.6366464017090,-22.4550825397882,-20.0253823983661,-7.85032285341362,8.83505166064638,22.2978363521391,25.8915514787056,17.3289018900441,0.0345657505376995,-18.1880383052730,-28.6779610047199,-26.0374646125302,-10.8895308096983,10.1289541180161,27.2687457738138,32.1999455488314,22.0631068396228,1.06789176911744,-21.2329302496286,-34.2989411392950,-31.5973416885228,-13.8644862848527,10.9930312229351,31.4267865078532,37.6288942753394,26.2519700711673,2.18952532721069,-23.5198597552431,-38.7720651335903,-36.1162160937874,-16.4016302206364,11.4353731684012,34.4319085160933,41.6569215005897,29.4260373494135,3.17643896882294,-24.9505770306571,-41.7446330725653,-39.1546864034287,-18.1633006478667,11.5641667688627,36.1433267553754,43.9797543247836,31.2605975248096,3.81748538037953,-25.5528428579035,-43.0765053157257,-40.4873472411553,-18.9438095956548,11.4862912226597,36.5454586628230,44.4911319814087,31.6208379568263,4.00757283927361,-25.3726478010660,-42.7590944544533,-40.0758697580184,-18.6995265400599,11.2406620144224,35.6765925350040,43.2348902248276,30.5511680269474,3.77207780595304,-24.4276610084205,-40.8635162614559,-38.0280001251726,-17.5322556458118,10.7812830948709,33.5770065933818,40.3286337513549,28.1973558680211,3.21660081760541,-22.7064675297808,-37.4832816473450,-34.5008794292756,-15.5868970064683,10.0495585481341,30.3088613860305,35.9301833799559,24.7375051552559,2.44947713215692,-20.2298345197797,-32.7644542149557,-29.6971612828911,-13.0210330125311,9.01633733651529,25.9916076441160,30.2502826957369,20.3648717220226,1.54133267761539,-17.0946741554746,-26.9283501054621,-23.8490931587470,-9.95054014316207,7.75581912602784,20.8665373574711,23.5830903190169,15.2748486472772,0.476511477693407,-13.5395224957919,-20.3346162255860,-17.2661527403463,-6.47591433406402,6.44233174416527,15.3171100341764,16.3487486945126,9.72402423289788,-0.783327634194421,-9.89278733399232,-13.4570708786263,-10.3478265872276,-2.73130651866015,5.27599478652516,9.78795562356957,9.02774158277204,3.99994566054363,-2.28187840781100,-6.50889116418922,-6.78989588235973,-3.48873567089686,1.17959642980811},
{7.86071241325251e-11,5.94305302870730e-10,-1.80435935835982e-09,-3.37807817488867e-08,-1.32681603305420e-07,-7.76033389849115e-09,2.05766926542126e-06,1.01722117027250e-05,2.68223731196679e-05,3.63534964897991e-05,-2.06864195918582e-05,-0.000245663089433789,-0.000684601436423560,-0.00111007737759580,-0.000829022104759327,0.00112578457404914,0.00510857321449604,0.00954980125577006,0.0104214671417931,0.00303627348600714,-0.0135462582020964,-0.0320857046366601,-0.0375699539782653,-0.0159026487449619,0.0320205578251720,0.0813486719303752,0.0914685319711217,0.0335828687672813,-0.0776527548282465,-0.175604613928844,-0.175124919999755,-0.0370129104720218,0.180288452771384,0.331992087134074,0.275429015170151,-0.0120844289656920,-0.375560522768842,-0.552654117521299,-0.353051051774943,0.168869018198976,0.691303347682621,0.810945451104027,0.340898757157451,-0.491235752690251,-1.12701241910040,-1.03991924321828,-0.150942223270307,1.01961805463199,1.63661839873275,1.13333934180936,-0.304948899033823,-1.75093256752566,-2.11752332394209,-0.959722064630155,1.08552165195256,2.61669176407254,2.41524835155362,0.392542537386204,-2.18620698238708,-3.47202358541005,-2.34564273545555,0.650171337629009,3.51315854843630,4.10561142741691,1.73566199699275,-2.16440073117034,-4.87384139378880,-4.27141535463476,-0.472947720605989,4.03172320078044,5.99431599660598,3.74125753984670,-1.44529595871785,-6.01228026312122,-6.56095772884151,-2.36393611162388,3.88239371528382,7.76975465309915,6.28391621891310,0.119877545785017,-6.55859482335603,-8.92279566661661,-4.96498665028040,2.84688039265856,9.08078487900128,9.11509834147679,2.55510847404036,-6.22806598311676,-11.0001045786971,-8.08794267742547,0.813690790998494,9.58537290683977,11.8881387949073,5.74230119193279,-4.82632173835449,-12.4101114698072,-11.4138315290293,-2.17564214447338,9.01583343936558,14.2000988977836,9.40980969232332,-2.31123994680893,-12.8215967738711,-14.5404883692668,-5.91617661612965,7.24085454428417,15.6685429374101,13.1788824763235,1.19693923128163,-12.0134337543079,-17.0524628326695,-10.0780106752362,4.28042138519140,15.9875193059286,16.6229591069219,5.44038138803803,-9.89731145396435,-18.5715983357170,-14.2471903505650,0.303318280424969,14.9635000319043,19.3139651817548,10.0444594054248,-6.54043143464924,-18.8103216596913,-17.9741451183160,-4.38244978893163,12.5539107312331,20.8865447006277,14.5678214527283,-2.16100954894424,-17.6151949504893,-20.8373705750824,-9.37351656014665,8.86920295491429,21.0820736699323,18.5580768959044,2.90334831694319,-14.9770124750081,-22.4842755263280,-14.2122281506446,4.15963602209560,19.7694180496883,21.5871783862698,8.21565944404418,-11.0442083524522,-22.6700175720436,-18.4216674340547,-1.18621126418697,16.9849522525270,23.3113726234003,13.2811217368635,-6.12948421426073,-21.3127050544807,-21.5782658075253,-6.68739888259737,12.9423768201406,23.5318421002056,17.6217715053324,-0.667120896621713,-18.5088836150409,-23.3752534519866,-11.8420385610241,7.99739121943532,22.2154940139864,20.8373859649909,4.84767103600254,-14.5107065707625,-23.6480788148284,-16.1787641723035,2.60851581781511,19.4956454844192,22.6437752672520,9.90428903756583,-9.71012593547766,-22.4051125804291,-19.3169840241147,-2.71185359500917,15.6715479381192,22.9274446974180,14.0556862030670,-4.58527880574936,-19.8351379263177,-21.0329612672832,-7.48193328788522,11.1578164178944,21.7598964552647,16.9875890482996,0.379482001900519,-16.2669224254765,-21.2839717792337,-11.3238664280124,6.40795859644470,19.3660160837332,18.5522124141208,4.77311071492708,-12.0912122148340,-20.1778560256056,-13.9978228197466,1.83707159151568},
{7.86071241325251e-11,4.60826705467997e-10,-3.43236841142348e-09,-3.42507710777373e-08,-6.52403205193173e-08,3.81901124282480e-07,2.77303545573756e-06,8.01893657191640e-06,9.30454684413556e-06,-1.71010054098118e-05,-0.000100815144006681,-0.000218049273639656,-0.000209631986531615,0.000191220201691493,0.00107180763846863,0.00190402403849732,0.00150944631283109,-0.000988624486135342,-0.00457441694376806,-0.00586009674669923,-0.00150615909161388,0.00735651425040204,0.0132555825347481,0.00751949806751554,-0.00962496578541672,-0.0241464046145512,-0.0179440685688673,0.0111727131759684,0.0393078800214363,0.0336186906744099,-0.0121513881883262,-0.0597440236116763,-0.0551286122060764,0.0132897334910421,0.0868064288710815,0.0828301780433283,-0.0158374291744686,-0.122015238025463,-0.116599438227110,0.0217751111542042,0.167219010785835,0.156078252811802,-0.0333586538869574,-0.223999345532096,-0.200179897810538,0.0533289075423254,0.293657626167294,0.247088824161645,-0.0847512890599925,-0.376992560625830,-0.294184954161534,0.130904311216080,0.474217813945445,0.338236588549007,-0.194827772258531,-0.584540739449509,-0.375269225972157,0.279210185319530,0.706086444131182,0.400705633904462,-0.386153674355388,-0.835814513716813,-0.409473642631318,0.517122401766383,0.969772067519661,0.396500633739313,-0.672537099655633,-1.10300828831227,-0.356813985134424,0.851837046528928,1.22996233608066,0.286046040791045,-1.05319724060012,-1.34447618916365,-0.180453389244551,1.27383824260033,1.44043547420735,0.0375319449001705,-1.50979793297482,-1.51194749559546,0.143694667571883,1.75580020238458,1.55334193801215,-0.362756004594182,-2.00548855936898,-1.55933029520592,0.617954787033566,2.25205362204593,1.52571296204467,-0.905955427463470,-2.48817466325028,-1.44939802376588,1.22194708324960,2.70629463601965,1.32847935950101,-1.55991642192944,-2.89900449363780,-1.16231397532073,1.91302705022743,3.05957964355260,0.951771508501427,-2.27377602467025,-3.18221586118303,-0.699134569429559,2.63449696346433,3.26262210162939,0.408470373530493,-2.98717011987713,-3.29771229407727,-0.0850529310839358,3.32403821494573,3.28587357445734,-0.264823316559152,-3.63794430905936,-3.22707030579663,0.634029941680018,3.92251410651706,3.12276071152997,-1.01484411261756,-4.17217498079407,-2.97547816694851,1.39960181812980,4.38262204911291,2.78890796877794,-1.78080049371824,-4.55072557569327,-2.56745716665517,2.15166033536515,4.67492785316879,2.31642223425620,-2.50599256772270,-4.75496570231687,-2.04163727150424,2.83836541384139,4.79169984108804,1.74912435662436,-3.14428946313120,-4.78692409068707,-1.44462466457664,3.42069326764183,4.74369076286860,1.13385461555262,-3.66557667955981,-4.66587538823148,-0.822180716265988,3.87804714498318,4.55798750621397,0.514475260091229,-4.05821325015482,-4.42488981933510,-0.214939775906751,4.20707550584178,4.27151514853294,-0.0730682538735771,-4.32643750261771,-4.10263737070541,0.347185676564721,4.41895037361662,3.92303289374007,-0.605545329913620,-4.48734033854158,-3.73676121120051,0.847156432592637,4.53446261217686,3.54713870328585,-1.07182213060403,-4.56315487726286,-3.35668012011634,1.28010003658178,4.57628779386256,3.16741147089348,-1.47279763445236,-4.57634395846118,-2.98073816531921,1.65088053985839,4.56534377439468,2.79753322533824,-1.81530578499708,-4.54476954617301,-2.61818423533943,1.96698579003875,4.51565778364194,2.44276833591680,-2.10666103152268,-4.47853558755986,-2.27089541871099,2.23530990039656,4.43404085288959,2.10229159767420,-2.35384604496958,-4.38294537563476,-1.93699397338912,2.46294910908501,4.32612101501338,1.77547354880428,-2.56278636400277,-4.26410675702200,-1.61808414026155,2.65358956214747,4.19760685123773},
{7.86071241325251e-11,3.35021362546272e-10,-4.55268319182550e-09,-3.02480530241642e-08,-6.20838011165348e-10,5.70910332706489e-07,2.39864309766423e-06,3.78490681839901e-06,-3.81100308305698e-06,-3.17975782872457e-05,-6.87986825410410e-05,-5.00897645451387e-05,0.000110307184261118,0.000379806400032327,0.000483257258426063,7.00929218915703e-05,-0.000773500487663592,-0.00121578842714952,-0.000332593605840492,0.00151462146825246,0.00229078206357439,0.000288244305337069,-0.00306648606226654,-0.00359304073265218,0.000773549912855490,0.00581182833806701,0.00444591199140517,-0.00385336361311075,-0.00953558596301839,-0.00331813693308426,0.00978392514976863,0.0128123201899762,-0.00188741256502083,-0.0181693925299207,-0.0126317382107983,0.0127782613383358,0.0263041347725928,0.00511345621335473,-0.0285910370889395,-0.0287820539288723,0.0125374231147228,0.0446356342102756,0.0190748619351526,-0.0389831959643926,-0.0521191004461238,0.00709573859543347,0.0665891485276502,0.0408999771914845,-0.0474332543456405,-0.0819312311485329,-0.00481217760344775,0.0904043940409870,0.0703513138685973,-0.0524075602529518,-0.116737505462793,-0.0235609067342405,0.114231635253763,0.106329916588141,-0.0528061763872318,-0.154432186511703,-0.0485706857990735,0.136346256491354,0.146851786507502,-0.0484765713438363,-0.192999199590154,-0.0785600091407294,0.155742801464621,0.190122345826672,-0.0395263627517490,-0.230801643098419,-0.112574821011409,0.171217479640978,0.234455594109690,-0.0255429410025301,-0.265581616614414,-0.149565053611607,0.180828481481350,0.277085202053160,-0.00655331116791007,-0.294315609904567,-0.186995418153259,0.183619948701778,0.314835032494968,0.0158980811492405,-0.315306487545369,-0.222316023634273,0.179881781548444,0.345708200042560,0.0401907438972023,-0.328030157857136,-0.253913798902055,0.170257097195176,0.368983331002633,0.0655651146308180,-0.332323006828937,-0.281228328601003,0.154768825731386,0.384179426313190,0.0917834873501848,-0.327926530637219,-0.304011890346542,0.133303124204400,0.391182351119974,0.119147678605349,-0.314449639502747,-0.322491288543736,0.105004804584478,0.389419366228886,0.148130685590423,-0.290774164318211,-0.336090023954189,0.0692878701229200,0.377794631480555,0.178310481453944,-0.256227034690254,-0.343782356330218,0.0264705242187991,0.355647965947526,0.208778642366111,-0.211060350593882,-0.345028916677235,-0.0228191271458387,0.323003413912431,0.239069421397599,-0.155498640621414,-0.339439529461887,-0.0781089215772527,0.279632340963685,0.268332459750113,-0.0899951916359782,-0.326357199587439,-0.138277887922424,0.225753363584241,0.295523999622420,-0.0155950955926250,-0.305429794050772,-0.201882670699111,0.162117179203908,0.319638006767978,0.0660264947963096,-0.277027607953766,-0.267582403453243,0.0901138621153736,0.340513671175498,0.153613028880988,-0.241735109417470,-0.334633834198440,0.0105585742575431,0.357752328458319,0.246126082710760,-0.199604123432841,-0.401831534084155,-0.0757231811147042,0.370498692199945,0.342034549801751,-0.150728138911360,-0.467516775663700,-0.167421498445181,0.377897663605873,0.439259766082259,-0.0958501343741152,-0.530227109040644,-0.262766929175971,0.379908568484110,0.536320579653759,-0.0357520091497094,-0.589126459465589,-0.360714657279752,0.376211690206919,0.632044239257425,0.0292978789354024,-0.643201636385969,-0.460538913076661,0.366075966915904,0.725313810878118,0.0996435127374924,-0.690830972604400,-0.561589871959341,0.347950608769873,0.814160174396919,0.175554112681188,-0.729604496953245,-0.662297542739750,0.320529676573697,0.896070962857753,0.256549686852076,-0.757469082223686,-0.760991255998138,0.282732725314714,0.968684998333459,0.342386732652403,-0.771869325999725,-0.855467688965467,0.233468175480139,1.02878774701053,0.431602094030546,-0.770850252850128,-0.942916249250735,0.172991084211990,1.07407865865968},
{7.86071241325251e-11,2.06633359493850e-10,-5.28168763293245e-09,-2.30990955837665e-08,5.34247412779091e-08,5.91295636722165e-07,1.51324182356895e-06,1.72437157310187e-07,-8.40029708308573e-06,-2.19092229323704e-05,-1.78534216083629e-05,3.30350283614702e-05,0.000112223755837276,0.000122194358808902,-1.99666035574250e-05,-0.000214231814703085,-0.000197476338334166,0.000117796364247927,0.000376426973488513,0.000135178887742384,-0.000417260289931673,-0.000479388952308171,0.000244181833120517,0.000808537071890529,0.000185650382390362,-0.000957672810041967,-0.000815369537471112,0.000769005616194555,0.00148134298625997,-0.000159204903791283,-0.00194147404174331,-0.000809966960083626,0.00197879516640190,0.00195736319869009,-0.00146474524827658,-0.00303653342639949,0.000387742587572227,0.00381202910385668,0.00120352923799018,-0.00401874748570970,-0.00313096625715299,0.00344571384561337,0.00512158689537198,-0.00195558438434065,-0.00680642903694521,-0.000460861476911367,0.00775182825183491,0.00362565427717342,-0.00753710658917080,-0.00714591551263552,0.00587043079000305,0.0104690283797889,-0.00264833153875643,-0.0129212808233427,-0.00194675004863000,0.0138352115477181,0.00741774595650005,-0.0127084612833331,-0.0130219871665925,0.00931550796972809,0.0178928184250912,-0.00373534623191461,-0.0211136229330035,-0.00358313238811709,0.0218672110562203,0.0118305781370206,-0.0195815668040069,-0.0198802651822838,0.0141246343790806,0.0264899250919682,-0.00586431768092520,-0.0305122346410371,-0.00435200071565658,0.0311290437115162,0.0153941729943477,-0.0278845439424667,-0.0259418368640883,0.0207347491225298,0.0345538185841697,-0.0101811607188764,-0.0399021513792613,-0.00274471977947123,0.0410019912023749,0.0166176897138062,-0.0373506205620039,-0.0297598824620254,0.0290873029750582,0.0405461256318654,-0.0169266119469545,-0.0476022787835050,0.00204072635270799,0.0499239325675514,0.0140397710047358,-0.0470067229546023,-0.0295877062267121,0.0389281102382405,0.0428938500478654,-0.0263167086002955,-0.0524228997994187,0.0103096454634644,0.0569695729630888,0.00753009715023356,-0.0557959465706732,-0.0253024222250840,0.0488502197222159,0.0410888783235152,-0.0367324058191023,-0.0531662226811799,0.0206286949735448,0.0602124791842756,-0.00216456682068976,-0.0614532086116132,-0.0167959885482214,0.0567114373630328,0.0343215622855058,-0.0464447221118907,-0.0486161212101400,0.0317389222781025,0.0582928704091156,-0.0141072179628154,-0.0624860865016276,-0.00469560244827500,0.0609106604647074,0.0228804910586277,-0.0538193878776484,-0.0387425870612922,0.0420173992534406,0.0508790197353165,-0.0267236631515161,-0.0583014734140730,0.00942291753015444,0.0604925587214597,0.00827224573673187,-0.0574482543453830,-0.0248003314727761,0.0496413373475501,0.0388232698176747,-0.0378660414850940,-0.0492205156362341,0.0232384186776907,0.0552024681812496,-0.00710927287704186,-0.0564006096760066,-0.00907435178430291,0.0529043960321847,0.0239344587751717,-0.0452168967261354,-0.0362935275797589,0.0341617946598198,0.0452460713004906,-0.0207999689030339,-0.0502206780773776,0.00632157141413080,0.0510021644352846,0.00806267694845608,-0.0477075144620018,-0.0211718097476851,0.0408447815349034,0.0320655288338007,-0.0311420298088434,-0.0400586077279404,0.0194464254757620,0.0446960150827112,-0.00668239759957957,-0.0457497805649244,-0.00618032402580199,0.0432389491097085,0.0181958320568384,-0.0373935563299645,-0.0284374720662654,0.0287105797337230,0.0360913546990534,-0.0179513426424191,-0.0405751586779059,0.00605490200872195,0.0416031564493849,0.00597952808811894,-0.0391784108147230,-0.0171726492167229,0.0335726053484211,0.0266262881655829,-0.0253078864403044,-0.0335831557114085,0.0151549957135679,0.0375727068177383,-0.00395074987927933,-0.0383455084548028,-0.00744430353036607,0.0358276154335426,0.0181128577638470,-0.0301914749229317,-0.0271484485277799,0.0219022514113891,0.0338118544850691,-0.0115887943615918,-0.0375023219142547,5.29920391316309e-05,0.0378223697347306,0.0117982205164353,-0.0345659140756031},
{7.86071241325251e-11,3.10974681051946e-11,-5.60112636536494e-09,-1.08235013226618e-08,9.38435077994146e-08,4.20576689997021e-07,3.31244347613362e-07,-1.74715828042604e-06,-5.29071700898381e-06,-4.16979639833605e-06,7.58063676631873e-06,2.19511452503864e-05,1.88395238223046e-05,-5.33396173939453e-06,-2.19289788263100e-05,-6.85166644901218e-06,1.66206740762428e-05,8.92131941266893e-06,-1.73980460066713e-05,-1.36148893272082e-05,1.74434621878304e-05,1.96005157079223e-05,-1.41253568333199e-05,-2.20577367326243e-05,1.17188564279911e-05,2.20572456411559e-05,-1.25056953046746e-05,-2.23640441571902e-05,1.65838120545198e-05,2.67463750672790e-05,-1.89721975653792e-05,-3.27765486099122e-05,1.76763695207443e-05,3.61442432245518e-05,-1.45864100865356e-05,-3.32187812366642e-05,1.73398475604538e-05,3.12312642671936e-05,-2.19759145720234e-05,-2.85911894127904e-05,3.03983292460004e-05,2.84778526430626e-05,-4.00807222430020e-05,-3.14124940635081e-05,4.78904770344222e-05,3.48574295388084e-05,-5.35215192878876e-05,-3.68027734352385e-05,5.84209080534575e-05,3.81157124418341e-05,-6.05804817131487e-05,-3.52625374245348e-05,6.32436865305126e-05,2.91475188699491e-05,-6.83716580014872e-05,-2.34102607395500e-05,7.28692279588794e-05,1.75338348044220e-05,-7.40916463254696e-05,-6.76876599772129e-06,7.68490573950414e-05,-6.41371021833630e-06,-8.23557262229973e-05,1.89842053047887e-05,9.03265479160478e-05,-2.59444033293454e-05,-9.34736760521782e-05,3.12719139938147e-05,9.02098231738409e-05,-3.90825819696896e-05,-8.18454817668965e-05,5.44392147075601e-05,7.88622206032756e-05,-6.71163606362919e-05,-7.79113707777579e-05,7.15146973874898e-05,6.85261044211857e-05,-7.65188572529025e-05,-5.38945710175780e-05,8.44049769625541e-05,3.79708765064444e-05,-9.34963349699849e-05,-2.11980869706047e-05,0.000105602405627100,1.05643795748140e-05,-0.000111494469392789,-4.34471430136495e-07,0.000110519273401084,-1.41294978510498e-05,-0.000108048319354916,3.01613023997095e-05,0.000103918842894785,-4.68330633036966e-05,-9.77017327333060e-05,6.54229465755175e-05,9.30812518039723e-05,-8.18668664384260e-05,-8.97451366082839e-05,9.20998882947016e-05,8.36860302887821e-05,-9.50351842434966e-05,-6.74666852847819e-05,0.000101458478420357,5.01610951160249e-05,-0.000107597439682033,-3.24716313474366e-05,0.000112246142113239,1.50196261679080e-05,-0.000114196798291324,2.13129106383516e-06,0.000111834553760655,-2.20652987666295e-05,-0.000109529768084649,4.13208478255873e-05,0.000108146382832146,-5.40493378689730e-05,-0.000100133383955821,6.55857680583180e-05,8.69481899469107e-05,-7.75881365549471e-05,-7.07568729590727e-05,9.05499904175212e-05,5.57815309005118e-05,-9.84801065966965e-05,-3.66027197951547e-05,0.000105560786848026,1.58506850800220e-05,-0.000111527776142372,4.83983286929676e-06,0.000114729163842659,-2.67183534088114e-05,-0.000117539241155489,4.63011047380967e-05,0.000118393954980099,-6.03252277582571e-05,-0.000109281761807929,7.87820167750128e-05,9.80030179628027e-05,-9.97336339889563e-05,-8.83519230542352e-05,0.000118459298281687,7.94466336352001e-05,-0.000132168548541154,-6.84437639915561e-05,0.000141431092720706,5.38591745514709e-05,-0.000148745845157446,-3.80573428149334e-05,0.000152971493047735,2.10339171175326e-05,-0.000154249200160242,-3.69253084425564e-06,0.000151731859731809,-1.33637267310138e-05,-0.000141669999571468,3.85206326612152e-05,0.000135702732728234,-6.23283275937048e-05,-0.000131641058203986,8.04490317103323e-05,0.000124096556742516,-9.49916829660600e-05,-0.000111820131992536,0.000108097223394827,9.58142167368561e-05,-0.000119515472666227,-7.38752507420014e-05,0.000135099606326225,5.26208128987603e-05,-0.000152922638054864,-3.63865624598520e-05,0.000166918443037771,2.27713753832524e-05,-0.000175008930338116,-8.26700703274011e-06,0.000179295949099499,-7.13303512584502e-06,-0.000181280835335162,2.12406911135733e-05,0.000178959035115743,-3.43261903679353e-05,-0.000168594654648754,5.51807252832328e-05,0.000161350256921074,-7.59319617565652e-05,-0.000156789788503642,9.03202372224835e-05,0.000146272770383596,-0.000104910721244371,-0.000131344642909260,0.000124345365975161,0.000121389881845723,-0.000138728598105278,-0.000110381545897178,0.000149383147033764,9.82495141341681e-05,-0.000153739064523635,-7.90882801084031e-05,0.000157437753130760,5.34066051253884e-05},
{7.86071241325251e-11,-1.03650483344874e-10,-5.31555607266262e-09,-1.44606603821032e-09,9.50037052161423e-08,2.29236410171701e-07,-1.60288585057656e-07,-1.38471182015727e-06,-1.89984810124999e-06,5.06320169946988e-07,4.67036123477430e-06,6.13836233988202e-06,3.11714999168109e-06,-9.65029109396393e-07,-2.40459695538653e-06,-1.34573635277848e-06,-7.61581022814064e-08,1.48585531113124e-08,-5.11235711696535e-07,-1.73273159986056e-07,9.19438767514566e-07,9.64269221829522e-07,-2.04102816342158e-07,-7.77794796522226e-07,-4.01473061439030e-07,-8.61389180846625e-08,3.07749468528211e-07,9.00354689822783e-07,6.19857608002931e-07,-4.83239847982280e-07,-1.01647447699962e-06,-6.21107164468368e-07,2.71472976727067e-07,1.27417800877946e-06,1.25074659150443e-06,-2.20691098839024e-07,-1.13075182225465e-06,-8.53275402548589e-08,1.14968150805023e-06,7.71929140943922e-07,-4.18405771518269e-07,-9.76865270511952e-07,-5.75070309604071e-07,4.11612898239552e-07,9.82420887093377e-07,1.59454865654886e-07,-1.02255442521074e-06,-4.11075576350615e-07,1.23667115484790e-06,9.56335356389228e-07,-7.18133970566898e-07,-6.44761157461180e-07,3.20573561569677e-07,-3.64525119913143e-07,-6.96813660414902e-07,7.15244305227277e-07,6.22958362080082e-07,-4.90761775050185e-07,8.86705861315483e-07,1.16872477518102e-06,-2.20737401301347e-06,-1.89927229608587e-06,2.74858470267384e-06,1.97505534176490e-06,-1.86963751023378e-06,1.14522113591466e-07,1.23579568869233e-06,-2.92857423397588e-06,-9.20845299347945e-07,5.00314648592448e-06,9.14365969010588e-07,-3.79033577213877e-06,1.94995790558748e-06,2.02891629160183e-06,-6.11068633822250e-06,-1.50452479610298e-06,7.23245799715644e-06,-6.60558769447647e-07,-6.10215030287707e-06,3.94749762062705e-06,3.29232443935082e-06,-6.68924432887566e-06,1.50930941134285e-06,9.19169410227715e-06,-5.05229848058443e-06,-8.01747579233726e-06,7.91580586466053e-06,3.14360165405650e-06,-1.03387335886538e-05,2.72234992708013e-06,9.97439998157198e-06,-8.71781040004943e-06,-6.49393075414568e-06,1.35706951171330e-05,1.33413081080069e-06,-1.46283515782144e-05,4.93518197827587e-06,1.09130205238541e-05,-1.14841181274562e-05,-3.55081329707245e-06,1.70002232205157e-05,-3.55700843232768e-06,-1.64301579251842e-05,1.14818773500393e-05,1.11065788199667e-05,-1.75495506585505e-05,-2.21858983007773e-06,1.96398409136821e-05,-8.08619286829154e-06,-1.68749141072566e-05,1.63340429691095e-05,8.16209610543164e-06,-2.15726144104300e-05,3.75911127578845e-06,2.25098803980336e-05,-1.41813938332088e-05,-1.62982722393959e-05,2.19103518503367e-05,4.83165699398581e-06,-2.48141351110967e-05,8.71865237996837e-06,2.19450959466505e-05,-1.95921997516403e-05,-1.17289442243551e-05,2.67346688386190e-05,-1.93795908815998e-06,-2.71704204442892e-05,1.56757498349133e-05,2.00492664468597e-05,-2.64840330386275e-05,-7.90449519577451e-06,3.01468537234836e-05,-7.18713519837122e-06,-2.54755695501992e-05,2.26114356585378e-05,1.60622601450796e-05,-3.11293087501284e-05,-1.93237489466803e-06,3.09767800921229e-05,-1.39549819355616e-05,-2.30234550126289e-05,2.69089303448993e-05,9.44660848593314e-06,-3.28964683526913e-05,6.51860000668337e-06,2.98545551695923e-05,-2.15941343704695e-05,-1.94089246591359e-05,3.12618965868628e-05,3.98117727263823e-06,-3.32602175200380e-05,1.20314418799944e-05,2.68606220905242e-05,-2.39530614674643e-05,-1.19251820156917e-05,3.18654191744041e-05,-4.14016996734262e-06,-3.12390659352163e-05,1.80462648206762e-05,2.16481049500482e-05,-2.76648379494902e-05,-6.67228259783614e-06,3.05001261645454e-05,-9.50613632149607e-06,-2.56533609778425e-05,2.34909126772998e-05,1.58874165998109e-05,-3.02178188661611e-05,-2.53764356301192e-06,2.85306119209635e-05,-1.18403024098731e-05,-2.05559711711355e-05,2.28094134213090e-05,8.62822807239600e-06,-2.71534310992195e-05,4.82435011854099e-06,2.43094612800511e-05,-1.70467464714165e-05,-1.63679307158550e-05,2.45222825111398e-05,5.95590404404660e-06,-2.39897005445916e-05,7.20531835331560e-06,1.93030178232816e-05,-1.77095824889738e-05,-1.18121815180985e-05,2.14310003358515e-05,7.83490339072628e-07,-2.01632606521874e-05,1.05790097234925e-05,1.63141436066270e-05,-1.67398024196964e-05,-8.19280171977871e-06,1.86687509410525e-05,-9.78470183775435e-07,-1.56360326959751e-05,1.01987417368808e-05,1.03780785402434e-05,-1.64517635396145e-05,-4.74717601092117e-06},
{7.86071241325251e-11,-2.93046299254356e-10,-4.13480020591041e-09,8.31199459963852e-09,6.08148866975786e-08,2.46529027061689e-08,-2.10481853655179e-07,-3.77909376323505e-07,-2.12396228528313e-07,3.21033951355622e-07,1.09271959597242e-06,1.32399604665358e-06,6.59685378643369e-07,2.46470654734598e-08,-3.55284518804993e-07,-5.82147284408359e-07,-1.21240307853350e-07,9.01791920123238e-08,-2.95865789155683e-07,1.57221610699642e-07,3.68707011466327e-07,-2.65890397053524e-07,1.70880941730401e-07,1.93785623462889e-07,-7.10723980997162e-07,2.09546021476064e-07,5.67110094464503e-07,-6.02410264530972e-07,3.90699876261431e-07,4.97279032105433e-07,-1.23177600098677e-06,2.72403573838518e-07,8.76555934947742e-07,-1.04619448088090e-06,6.78080357200459e-07,9.58933554106764e-07,-1.71727597127038e-06,5.92530669374726e-07,1.33413002284490e-06,-1.80624702682659e-06,6.37607300431539e-07,1.22787186288894e-06,-2.34649866128046e-06,8.75320729985842e-07,1.73320838046248e-06,-2.57360574339888e-06,8.24828614520088e-07,1.83528062179458e-06,-2.75246867673686e-06,1.11000686590900e-06,2.04063404794049e-06,-3.24401528999518e-06,9.48226648302904e-07,2.16596514706567e-06,-3.39352467716719e-06,1.11411012169605e-06,2.49684221971056e-06,-3.39176656920303e-06,1.17409921872798e-06,2.45634852933698e-06,-3.86163492418839e-06,9.55580539183166e-07,2.86242273093975e-06,-3.44466451768407e-06,1.03134482257743e-06,2.71996099073097e-06,-3.93102042185245e-06,5.89744557661873e-07,3.14038656155318e-06,-3.28777472516796e-06,6.88222409412355e-07,3.26527455217517e-06,-3.58398962656294e-06,-3.19568104431204e-07,3.10806203862966e-06,-3.16438590755661e-06,-2.86856978647354e-07,3.76111528470152e-06,-2.84713170065248e-06,-1.24377317582867e-06,3.79061592744032e-06,-2.20842592035152e-06,-1.49070844043996e-06,4.27174541745557e-06,-2.00007939204917e-06,-2.81514103772660e-06,4.26102464284506e-06,-1.34297001568325e-06,-3.40875152752907e-06,4.74881044858981e-06,-7.89625047669271e-07,-4.49590602730759e-06,5.17394619756262e-06,1.41873837590638e-07,-5.46445680195286e-06,5.23055672848229e-06,4.62253424685214e-07,-6.65580683315798e-06,6.00437689753794e-06,1.81977376006776e-06,-7.60080119560553e-06,6.07988322810780e-06,2.19831238865460e-06,-8.99781830063502e-06,6.52500977440702e-06,3.18482146985819e-06,-1.01562351172964e-05,6.84291025403479e-06,3.91049738443450e-06,-1.14942580862877e-05,7.13064525271114e-06,4.75889022492375e-06,-1.24336650331865e-05,7.89132904685925e-06,5.69476216568131e-06,-1.37812435324685e-05,7.93254947915095e-06,6.16166301580464e-06,-1.48096071114485e-05,8.61482755626022e-06,6.96119646528015e-06,-1.57784826589140e-05,9.05340802745199e-06,7.41039261269192e-06,-1.68296212744294e-05,9.35354323892495e-06,7.71977389079962e-06,-1.75603910149114e-05,9.86593130739084e-06,7.85101208521291e-06,-1.83336070659685e-05,1.03734376272991e-05,8.20854762316221e-06,-1.83941188878667e-05,1.10196237908694e-05,7.86531866696910e-06,-1.91318224914333e-05,1.10938986347074e-05,7.55367259831619e-06,-1.88430396340353e-05,1.18367462877115e-05,7.02833216420742e-06,-1.89375742715197e-05,1.20450959694158e-05,6.34132879781433e-06,-1.84558257395735e-05,1.24668048842479e-05,5.46176042203895e-06,-1.78458719092211e-05,1.28136544360037e-05,4.32384546474272e-06,-1.71147999634994e-05,1.33330368944444e-05,3.54071214171759e-06,-1.58849807220617e-05,1.34149009900974e-05,1.65590227323282e-06,-1.52131071682940e-05,1.36355609182001e-05,5.53240779643266e-07,-1.36168860374579e-05,1.38328776383172e-05,-1.24114795785828e-06,-1.23739281610905e-05,1.42095981524949e-05,-2.43963299429233e-06,-1.07942116907257e-05,1.38977778815227e-05,-4.61429265062653e-06,-9.32201878228959e-06,1.43583164246661e-05,-5.86093662430033e-06,-7.67248967772375e-06,1.41220704971480e-05,-7.66938132613627e-06,-5.96904888525386e-06,1.40847734776313e-05,-9.41461426124126e-06,-4.27695915590394e-06,1.42937594106001e-05,-1.05609636102479e-05,-2.40738248827055e-06,1.38605913954202e-05,-1.25858670243580e-05,-1.12518957368440e-06,1.35291034677369e-05,-1.38542971041271e-05,8.41544921736360e-07,1.36277795739429e-05,-1.48658430683902e-05,2.45450235566130e-06,1.29696164144239e-05,-1.64429015046456e-05,3.85026774139912e-06,1.28479382985072e-05,-1.70612203291768e-05,5.31485125656468e-06,1.19019047114978e-05,-1.84844670697846e-05,6.52109621184388e-06},
{7.86071241325251e-11,-3.89997125896635e-10,-3.17794131457531e-09,1.04808121973611e-08,3.52866590864652e-08,-1.59309871350217e-08,-1.06548777489345e-07,-1.57630379835432e-07,-1.30219618637534e-07,2.00094809369362e-07,5.25185624486482e-07,4.84135494085696e-07,4.16484790990107e-07,1.83674959122842e-08,-3.34843357928429e-07,-1.84120457612252e-08,-1.92034896499347e-07,-1.66598483114194e-07,3.09628072688445e-07,-2.57059015663392e-07,5.87101396849155e-08,4.41012457951854e-07,-5.48952142325387e-07,2.35729161460999e-07,2.17490416029846e-07,-7.79249107960970e-07,7.90079126325838e-07,-7.29644662488505e-09,-7.49266493905591e-07,1.14071569267143e-06,-8.02955856499022e-07,-4.94647971533764e-07,1.49136898351435e-06,-1.34842371770964e-06,3.72037626160132e-07,1.28801253613273e-06,-2.12415041225652e-06,1.31539610160368e-06,6.69820410099195e-07,-2.26079647854693e-06,2.34186629142444e-06,-6.20530837387975e-07,-1.96849361724787e-06,3.16070183044649e-06,-1.92898916394871e-06,-8.93213498785884e-07,3.29528519538009e-06,-3.32541975415169e-06,7.15647486054000e-07,2.80634180547252e-06,-4.26064317321141e-06,2.42847178437826e-06,1.38846103213760e-06,-4.52523497293521e-06,4.14184499903468e-06,-4.39040900276319e-07,-3.81481515112530e-06,5.41820941604033e-06,-2.58649896335048e-06,-2.44514367818243e-06,5.68618891617543e-06,-4.70169227384038e-06,-1.98778824075232e-07,5.36800906780966e-06,-6.18809734311496e-06,2.15209851196770e-06,3.69678936860274e-06,-7.06244596587157e-06,4.71322435444104e-06,1.72897702877416e-06,-6.68171830558290e-06,6.71624287252695e-06,-1.17306175479076e-06,-5.77525817774707e-06,7.86256790948508e-06,-3.88781948376079e-06,-3.49167751120033e-06,8.43224143308891e-06,-6.45353566881862e-06,-9.53366688457231e-07,7.73981860520525e-06,-8.38364344889012e-06,2.29204936819519e-06,6.25984854303274e-06,-9.77821288911067e-06,5.20426155506881e-06,3.68476951379871e-06,-1.00872510552897e-05,8.28346974935637e-06,5.84496191327949e-07,-9.39178623552157e-06,1.07206802956086e-05,-3.10702888864899e-06,-7.40284928500978e-06,1.24141565899964e-05,-7.27383469827960e-06,-4.46232386254949e-06,1.29024589610472e-05,-1.10473956403956e-05,7.00144513964967e-08,1.19946012435656e-05,-1.45380576953173e-05,5.10111546580043e-06,9.09028359157707e-06,-1.66775225803245e-05,1.08643171266524e-05,4.40117137988616e-06,-1.69877291363729e-05,1.62571950128747e-05,-2.12806239682889e-06,-1.48521870410185e-05,2.05379977452916e-05,-9.66646077619800e-06,-9.70269486699699e-06,2.26118611284532e-05,-1.76395385643266e-05,-2.13596804751678e-06,2.12926328309785e-05,-2.43991378837480e-05,7.80333700742990e-06,1.63055507453777e-05,-2.85261494619624e-05,1.84819467278975e-05,7.27494792601774e-06,-2.86877225817949e-05,2.81623415453223e-05,-4.93832433188495e-06,-2.36964590993895e-05,3.49015526399732e-05,-1.87698319291909e-05,-1.34980162498929e-05,3.66465081056521e-05,-3.16938230242098e-05,1.35933443156083e-06,3.20281855191269e-05,-4.14085254809080e-05,1.82585232206956e-05,2.04026396229427e-05,-4.49875455298891e-05,3.50153051000373e-05,3.34006726503253e-06,-4.07457007079403e-05,4.76197291713681e-05,-1.72312535701093e-05,-2.82334958656127e-05,5.33183253892997e-05,-3.74172927025691e-05,-8.66995852259340e-06,4.97875215677979e-05,-5.33473639640145e-05,1.49953248024527e-05,3.65263574528994e-05,-6.12027093997425e-05,3.89274019709240e-05,1.50680379981044e-05,-5.88221653823816e-05,5.78980270592630e-05,-1.17747605339982e-05,-4.52860709460458e-05,6.85728556276909e-05,-3.87800240708166e-05,-2.21520894624089e-05,6.74738394885158e-05,-6.13882697207468e-05,7.16756342782585e-06,5.42950410274769e-05,-7.46881602005789e-05,3.73085049425534e-05,2.98788289703614e-05,-7.55995236793611e-05,6.33187298980245e-05,-1.28620936374236e-06,-6.29331990915496e-05,7.94755354318809e-05,-3.45013922620413e-05,-3.82474609224435e-05,8.25080995838407e-05,-6.34663419698514e-05,-5.35714278421284e-06,7.11971543637336e-05,-8.24484556494640e-05,3.01436403716999e-05,4.65448527378749e-05,-8.81558981262580e-05,6.15941974248963e-05,1.28123749126288e-05,-7.83685815225768e-05,8.37554072350847e-05,-2.40569201846344e-05,-5.46105245475985e-05,9.19159873163032e-05,-5.81084957431114e-05,-2.11170884120142e-05,8.44370886676409e-05,-8.26839151191314e-05,1.70096355448851e-05,6.24715833995738e-05,-9.39396900529590e-05,5.24456881380349e-05,2.95852681563466e-05},
{7.86071241325251e-11,-4.85820273514363e-10,-1.99770557726379e-09,9.97167848942005e-09,1.23211317850009e-08,-1.47663707676654e-08,-3.37499725981949e-08,-9.80300328065338e-08,-4.00878271049335e-08,1.05739281482717e-07,1.39599796609442e-07,2.99314584204610e-07,1.09515735792613e-07,-5.89104939711303e-08,6.59215533053327e-08,-2.86343831983030e-07,7.69637628037046e-08,4.44042525858687e-08,-2.91567807492615e-07,4.49770690280005e-07,-3.34366547228751e-07,5.67835789765498e-08,4.30539294978518e-07,-8.17904022579601e-07,7.68048469167944e-07,-3.26925505373722e-07,-4.57984565892906e-07,1.26092516069400e-06,-1.44862490503473e-06,8.81285401693348e-07,2.77434422388668e-07,-1.67264143594807e-06,2.36793138321156e-06,-1.81960537236037e-06,2.38909820269743e-07,1.91596755804599e-06,-3.41496449189439e-06,3.25561085911349e-06,-1.22911039905558e-06,-1.82354400737358e-06,4.46210587585102e-06,-5.11055259951414e-06,2.93943379217157e-06,1.19194819548010e-06,-5.34864234464808e-06,7.25274171541306e-06,-5.43608562702844e-06,3.10926116038407e-07,5.77840155437947e-06,-9.54405174968578e-06,8.66221056694913e-06,-2.89339409644081e-06,-5.31266859449161e-06,1.16525132979160e-05,-1.25240403464954e-05,6.65971886161944e-06,3.59405707161488e-06,-1.30862408771648e-05,1.66961449087523e-05,-1.16604050490768e-05,-3.17288442390359e-07,1.33733782909452e-05,-2.06737285556416e-05,1.76966782255562e-05,-4.76487633748910e-06,-1.19944735370278e-05,2.39306214765150e-05,-2.43336913943690e-05,1.16856209016064e-05,8.46642542839863e-06,-2.57798462050127e-05,3.10571779351453e-05,-2.02068749195414e-05,-2.44574718286653e-06,2.55210324032643e-05,-3.70983485552146e-05,2.99024236472937e-05,-6.20794511800364e-06,-2.25455217917859e-05,4.15486219975640e-05,-4.00639975327294e-05,1.73069558195541e-05,1.62973541815656e-05,-4.35153467978585e-05,4.97568484596822e-05,-3.02785686144828e-05,-6.49816883584050e-06,4.21153575148169e-05,-5.78835502318104e-05,4.42841814962133e-05,-6.67855964720222e-06,-3.66262873974424e-05,6.32460768730898e-05,-5.82448911846938e-05,2.26361126961715e-05,2.66555282558810e-05,-6.46923421457486e-05,7.08453855008687e-05,-4.04570362477171e-05,-1.23006639720209e-05,6.12875777002320e-05,-8.05861551166995e-05,5.89480961042998e-05,-5.88435764918400e-06,-5.24876043602318e-05,8.60837573955953e-05,-7.64904824686051e-05,2.70201012771277e-05,3.82353857893745e-05,-8.62049680006263e-05,9.13615215025737e-05,-4.97007726583690e-05,-1.89371097627241e-05,8.01415108021822e-05,-0.000101963869576021,7.21442460779917e-05,-4.42535958396365e-06,-6.75706446223259e-05,0.000106857260311481,-9.24466380642652e-05,3.03733843893317e-05,4.88491560469069e-05,-0.000104923779810933,0.000108704256251955,-5.70298206041835e-05,-2.48780779508190e-05,9.57246275456800e-05,-0.000119155095707486,8.22733033722142e-05,-2.86542247435290e-06,-7.94057675365190e-05,0.000122529506987379,-0.000103964453100490,3.23866046367935e-05,5.67623495485100e-05,-0.000118113015509513,0.000120206514517226,-6.14156311363835e-05,-2.92275424714212e-05,0.000105888848413965,-0.000129481731826097,8.76974908381331e-05,-1.19002589377424e-06,-8.65094361517864e-05,0.000130845704405956,-0.000109190161660338,3.21832034705339e-05,6.13449373259124e-05,-0.000124071047520429,0.000124138643037471,-6.14699700743791e-05,-3.23187113812359e-05,0.000109716260084414,-0.000131425641256025,8.68154324973375e-05,1.65465750747434e-06,-8.89525201218460e-05,0.000130770762096330,-0.000106363037753846,2.83017889266780e-05,6.35590057241591e-05,-0.000122517445379369,0.000118978109296903,-5.53192806581576e-05,-3.56719561185681e-05,0.000107693491968413,-0.000124223354588419,7.76244596281862e-05,7.58841617299635e-06,-8.78590756857546e-05,0.000122315469836855,-9.40901186534686e-05,1.86074591932197e-05,6.50333961040367e-05,-0.000114095780441478,0.000104123312818911,-4.13359522052845e-05,-4.12943325871766e-05,0.000101044373489572,-0.000107816893260464,5.93966585852496e-05,1.84698168473088e-05,-8.48877802008776e-05,0.000106031444810495,-7.21976172973485e-05,1.89075737872571e-06,6.74197190965709e-05,-0.000100006907627278,7.99231675338631e-05,-1.87497389517355e-05,-5.03445937261978e-05,9.12525572367717e-05,-8.32815473592481e-05,3.17757563068969e-05,3.50088408749449e-05,-8.13494224974405e-05,8.34388266912552e-05,-4.11566551590870e-05,-2.20681335055758e-05,7.17516136393723e-05}};
		// Filtering routines for the laser-tag project.
		// Filtering is performed by a two-stage filter, as described below.

		// 1. First filter is a decimating FIR filter with a configurable number of taps and decimation factor.
		// 2. The output from the decimating FIR filter is passed through a bank of 10 IIR filters. The
		// characteristics of the IIR filter are fixed.

		// The decimation factor determines how many new samples must be read for each new filter output.
		//uint16_t filter_getFirDecimationFactor();

		// Must call this prior to using any filter functions.
		// Will initialize queues and any other stuff you need to init before using your filters.
		// Make sure to fill your queues with zeros after you initialize them.

		void initXQueue() {
			queue_init(&xQueue, X_QUEUE_SIZE);
			for (int j=0; j<X_QUEUE_SIZE; j++)
				queue_overwritePush(&xQueue, 0.0);
		}

		void initYQueue() {
			queue_init(&yQueue, Y_QUEUE_SIZE);
			for (int j=0; j<Y_QUEUE_SIZE; j++)
				queue_overwritePush(&yQueue, 0.0);
		}

		void initZQueues() {
			for (int i=0; i<FILTER_IIR_FILTER_COUNT; i++) {
				queue_init(&(zQueue[i]), Z_QUEUE_SIZE);
				for (int j=0; j<Z_QUEUE_SIZE; j++)
					queue_overwritePush(&(zQueue[i]), 0.0);
			}
		}

		void filter_init() {
			// Init queues and fill them with 0s.
			initXQueue();  // Call queue_init() on xQueue and fill it with zeros.
			initYQueue();  // Call queue_init() on yQueue and fill it with zeros.
			initZQueues(); // Call queue_init() on all of the zQueues and fill each z queue with zeros.
		}

		// Print out the contents of the xQueue for debugging purposes.
		void filter_printXQueue() {
			queue_print(&xQueue);
		}

		// Print out the contents of yQueue for debugging purposes.
		void filter_printYQueue() {
			queue_print(&yQueue);
		}

		// Print out the contents of the the specified zQueue for debugging purposes.
		void filter_printZQueue(uint16_t filterNumber) {
			queue_print(&(zQueue[filterNumber]));
		}

		// Use this to copy an input into the input queue (x_queue).
		void filter_addNewInput(double x) {
			queue_overwritePush(&xQueue, x);
		}

		// Invokes the FIR filter. Returns the output from the FIR filter. Also adds the output to the y_queue for use by the IIR filter.
		double filter_firFilter() {
			// += accumulates the result during the for-loop. Must start out with y = 0.
			double y = 0.0;
			// This for-loop performs the identical computation to that shown above. for-loop is correct way to do it.
			for (int i=0; i<FIR_COEF_COUNT; i++) {
				y += queue_readElementAt(&xQueue, i) * firBcoeff[FIR_COEF_COUNT-1-i];  // iteratively adds the (b * input) products.
			}
			queue_overwritePush(&yQueue,y);
			return y;	// Might be wrong
		}

		// Use this to invoke a single iir filter. Uses the y_queue and z_queues as input. Returns the IIR-filter output.
		double filter_iirFilter(uint16_t filterNumber) {
			double aSum = 0.0, bSum = 0.0, z = 0.0;;
			for (int i=0; i<IIR_B_COEFFICIENT_COUNT; i++) {
				bSum += queue_readElementAt(&yQueue, i) * iirBcoeff[filterNumber][IIR_B_COEFFICIENT_COUNT-1-i];  // iteratively adds the (b * input) products.
			}
			for (int i=0; i<IIR_A_COEFFICIENT_COUNT; i++) {
				aSum += queue_readElementAt(&(zQueue[filterNumber]), i) * iirAcoeff[filterNumber][IIR_A_COEFFICIENT_COUNT-1-i];  // iteratively adds the (b * input) products.
			}
			z = bSum - aSum;
			queue_overwritePush(&(zQueue[filterNumber]),z);
			return z;
		}

		// Use this to compute the power for values contained in a queue.
		// If force == true, then recompute everything from scratch.
		double filter_computePower(uint16_t filterNumber, bool forceComputeFromScratch, bool debugPrint) {
			return 0;
		}

		double filter_getCurrentPowerValue(uint16_t filterNumber) {
			return 0;
		}

		// Uses the last computed-power values, scales them to the provided lowerBound and upperBound args, returns the index of element containing the max value.
		// The caller provides the normalizedArray that will contain the normalized values. indexOfMaxValue indicates the channel with max. power.
		void filter_getNormalizedPowerValues(double normalizedArray[], uint16_t* indexOfMaxValue) {

		}

		void filter_runTest() {
			filter_init();             // Standard init function.
			bool success = true, iirsuccess = true;	     // Be optimistic
			uint16_t failedIndex = 0, failedFilter = 0;  // Keep track of the index where things failed.
			for (uint16_t i=0; i<TEST_DATA_COUNT; i++) {
				// No decimation for this test - just invoke the FIR filter each time you add new data.
				filter_addNewInput(inputData[i]);
				// You may need to perform the equality comparison differently as
				// filter outputs and test data may not match exactly. If you are within 0.000001, you are probably close enough.
				double firOut = filter_firFilter();
				if (fabs(firOut-outputFIRData[i]) > .00001) {  // Is the output what you expected?
					success = false;                                 // Nope, note failure and break out of the loop.
					failedIndex = i;                                 // Note the failed index.
					break;
				}
				for(int j = 0; j < FILTER_IIR_FILTER_COUNT; j++) {
					double iirOut = filter_iirFilter(j);
					if(fabs(iirOut - outputIIRData[j][i]) > .0001) {
						success = false;
						iirsuccess = false;
						failedIndex = i;
						failedFilter = j;
						break;
					}
				}
			}
			if (success) {
				printf("Success!\n\r");
			}
			else {
				printf("Failure!\n\r");
				printf("First failure detected at index: %d\n\r", failedIndex);
				if(!iirsuccess) {
					printf("First failure detected at filter: %d\n\r", failedFilter);
				}
			}
		}
